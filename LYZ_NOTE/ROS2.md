# ROS2

## 1.什么是ROS2

​	ROS 2 (Robot Operating System 2) 是一个开源的、用于机器人软件开发的**框架和中间件**。它不是一个传统意义上的操作系统（像 Windows 或 Linux），而是一系列软件库和工具的集合，旨在简化创建复杂和健壮的机器人行为的任务。	

​	ROS2的特点去中心化，节点之间可以自动发现并通信，这使得系统更加稳定可靠。

​	ROS2的设计更加轻量和模块化，可以通过micro-ROS在资源受限的嵌入式设备上运行。

### 1.1.1DDS通信

​	DDS通信是一种以数据外中心的，他关心的不是“发送消息”，而是“共享数据”

​	网络中的每个程序，都可以向这个虚拟的白板上写数据，或者订阅自己感兴趣的数据。

​	工作方式：发布/订阅

​	发布者：像一个作者，向“白板”上的特定栏目（成为Topic）发布最新消息。

​	订阅者：只关注自己感兴趣的Topic，例如，导航软件订阅“当前位置”

​	发布者和订阅者互不关心对方的存在，它只关心数据本身，实现了完全解耦。

三大特性：

​	去中心化没有中央服务器。节点之间一旦匹配，就会建立直接通信链路。

​	自动发现：新节点加入网络后，会自动广播自己的身份和需求直接通信链路。

​	强大的服务质量：这是DDS的王牌

​			可靠性，时效性，持久性

## 2.ROS2核心概念

### 2.1工作空间

在ros开发中，工作空间是开发一个项目，所放的东西的位置。下面有四个子目录，或者叫做四个子空间

![image-20251016154947367](C:\Users\33231\AppData\Roaming\Typora\typora-user-images\image-20251016154947367.png)

src，代码空间

build，编译空间

install，安装空间

log，日志空间

### 2.2机器人的工作细胞



![image-20251018144900568](C:\Users\33231\AppData\Roaming\Typora\typora-user-images\image-20251018144900568.png)

​	在机器人身体里搭载了一台计算机A，它可以通过机器人的眼睛——摄像头，获取外界环境的信息，也可以控制机器人的腿——轮子，让机器人移动到想要去的地方。除此之外，可能还会有另外一台计算机B，放在你的桌子上，它可以远程监控机器人看到的信息，也可以远程配置机器人的速度和某些参数，还可以连接一个摇杆，人为控制机器人前后左右运动。

​	**这些功能虽然位于不同的计算机中，但都是这款机器人的工作细胞，也就是节点，他们共同组成了一个完整的机器人系统。**

- 节点在机器人系统中的职责就是**执行某些具体的任务**，从计算机操作系统的角度来看，也叫做进程；

- 每个节点都是一个可以**独立运行的可执行文件**，比如执行某一个python程序，或者执行C++编译生成的结果，都算是运行了一个节点；

- 既然每个节点都是独立的执行文件，那自然就可以想到，得到这个执行文件的**编程语言可以是不同的**，比如C++、Python，乃至Java、Ruby等更多语言。

- 这些节点是功能各不相同的细胞，根据系统设计的不同，可能位于计算机A，也可能位于计算机B，还有可能运行在云端，这叫做**分布式**，也就是可以分布在不同的硬件载体上；

- 每一个节点都需要有**唯一的命名**，当我们想要去找到某一个节点的时候，或者想要查询某一个节点的状态时，可以通过节点的名称来做查询。

  ## 2.1 话题

  ![image-20251018145123552](C:\Users\33231\AppData\Roaming\Typora\typora-user-images\image-20251018145123552.png)

  ## 2.1发布/订阅模型

  ![image-20251018145153597](C:\Users\33231\AppData\Roaming\Typora\typora-user-images\image-20251018145153597.png)

  类似这样的发布/订阅模型在生活中随处可见，比如订阅报纸、订阅杂志等等

  ## 2.2异步通信

​	异步的特性也让话题更适合用于一些周期发布的数据，比如传感器的数据，运动控制的指令等等，如果某些逻辑性较强的指令，比如修改某一个参数，用话题传输就不太合适了。

##      2.3消息接口

​	既然是数据传输，发布者和订阅者就得统一数据的描述格式，不能一个说英文，一个理解成了中文。在ROS中，话题通信数据的描述格式称之为消息，对应编程语言中数据结构的概念。比如这里的一个图像数据，就会包含图像的长宽像素值、每个像素的RGB等等，在ROS中都有标准定义。

##     2.4通信接口

​	ROS通信系统的精髓，在于其为话题（Topics）、服务（Services）和动作（Actions）这三种核心机制定义了一套标准化的通信接口。这套接口就像是节点之间必须遵守的“契约”，它严格规定了传输数据的类型、结构和含义。

例如，无论是何种品牌的摄像头，其驱动节点发布的图像数据都遵循通用的图像消息格式；同样，无论是键盘还是手柄发出的控制指令，最终都会被包装成标准的线速度与角速度消息。这种标准化的设计极大地降低了程序间的耦合度，开发者无需关心底层硬件驱动或算法的具体实现，只需订阅或发布符合接口标准的数据即可。这使得代码复用和模块替换变得极其容易，从而让开发者能专注于应用层面的创新，真正践行了“减少重复造轮子”的核心理念。

##   2.5分布通信

​	在ROS系统中，机器人功能是由各种节点组成的，这些节点可能位于不同的计算机中，这种结构可以将原本资源消耗较多的任务，分配到不同的平台上，减轻计算压力，这就是分布式通信框架的典型应用之一。

![image-20251018145732345](C:\Users\33231\AppData\Roaming\Typora\typora-user-images\image-20251018145732345.png)

在机器人开发中，我们常将底层硬件控制（如传感器驱动、电机控制）部署在树莓派等嵌入式控制器上，而将视觉处理、路径规划等计算密集型任务放在性能更强的笔记本电脑上。ROS系统通过其强大的“网络透明性”完美地解决了这种分布式架构的通信难题。其核心在于，所有设备上的节点都向同一个ROS Master（主节点）注册，Master帮助它们互相发现并建立直接的点对点数据连接。这使得开发者在编写代码时，无需关心节点是运行在本地还是远程计算机上，从而能够像在单机上一样进行开发，极大地简化了多机协作机器人的系统搭建与调试工作。
